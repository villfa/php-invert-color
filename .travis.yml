language: php

matrix:
  include:
    - php: '7.1'
    - php: '7.2'
    - php: '7.3'
    - php: '7.4'
      env: FULL_TEST='true'
    - php: nightly
      env: COMPOSER_OPTIONS='--ignore-platform-reqs'
  fast_finish: true
  allow_failures:
  - php: nightly

cache:
  directories:
    - $HOME/.composer/cache

before_script:
 - if php -v | grep -q 'Xdebug'; then phpenv config-rm xdebug.ini; fi
 - composer install $COMPOSER_OPTIONS

script:
  - |
    if [ "$FULL_TEST" == "true" ]; then
      composer run-script test
    else
      composer run-script ut
    fi
